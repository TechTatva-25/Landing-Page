"use strict";(()=>{var e={};e.id=444,e.ids=[444],e.modules={5890:e=>{e.exports=require("better-sqlite3")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7790:e=>{e.exports=require("assert")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},9801:e=>{e.exports=require("os")},6624:e=>{e.exports=require("querystring")},6162:e=>{e.exports=require("stream")},4175:e=>{e.exports=require("tty")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},1300:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>A,patchFetch:()=>g,requestAsyncStorage:()=>q,routeModule:()=>E,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m});var i={};t.r(i),t.d(i,{POST:()=>c,dynamic:()=>d});var s=t(9303),a=t(8716),n=t(670),o=t(5890),u=t.n(o),p=t(7410),l=t(8706);let d="force-dynamic",T=p.z.object({name:p.z.string().min(1,"name is required").max(200,"Given name is too long"),email:p.z.string().email("Invalid email format").max(500,"Given email is too long"),query:p.z.string().min(1,"query is required").max(3e3,"Query is too long")});async function c(e){if(!e.body)return(0,l.VR)("Invalid data","Request body is empty",400);let r=await e.json(),t=T.safeParse(r);if(!t.success)return(0,l.VR)(t.error.errors[0].message,"",400);let{name:i,email:s,query:a}=r,n=u()(l.MW);n.prepare(`CREATE TABLE IF NOT EXISTS queries (
	  id INTEGER PRIMARY KEY AUTOINCREMENT,
	  name TEXT NOT NULL,
	  email TEXT NOT NULL,
	  query TEXT NOT NULL,
	  resolved BOOLEAN NOT NULL DEFAULT false,
	  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP,
	  updatedAt DATETIME DEFAULT CURRENT_TIMESTAMP
	)`).run(),n.prepare(`CREATE TRIGGER IF NOT EXISTS update_queries_updatedAt
	AFTER UPDATE ON queries
	FOR EACH ROW
	BEGIN
	  UPDATE queries
	  SET updatedAt = CURRENT_TIMESTAMP
	  WHERE id = OLD.id;
	END;`).run();try{return n.prepare(`
		  INSERT INTO queries (name, email, query)
		  VALUES (?, ?, ?)
		`).run(i,s,a),(0,l.Xj)({message:"Your query has been received. We will be contacting you shortly."})}catch(e){return console.error("Error saving query to database:",e),(0,l.VR)("Failed to submit query; please try again after a while","",500)}}let E=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/v1/query/route",pathname:"/api/v1/query",filename:"route",bundlePath:"app/api/v1/query/route"},resolvedPagePath:"/Users/shubhampanda/Desktop/newmhash/Landing-Page/src/app/api/v1/query/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:q,staticGenerationAsyncStorage:m,serverHooks:y}=E,A="/api/v1/query/route";function g(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},8706:(e,r,t)=>{t.d(r,{MW:()=>n,TQ:()=>p,VR:()=>u,Xj:()=>o});var i=t(8566),s=t.n(i),a=t(7070);let n=process.env.SQLITE_DB_PATH??"landing_page_queries.db";function o(e,r){let t=a.NextResponse.json({ok:!0,data:e},{status:r?.status||200});return r?.headers&&Object.entries(r.headers).forEach(([e,r])=>{t.headers.set(e,r)}),t}function u(e,r,t){return r&&console.error(r),a.NextResponse.json({ok:!1,message:e},{status:t})}async function p(e){let r=e.headers.get("x-forwarded-for"),t=r?.split(/, /)[0]??"";try{let e=await s()(t);if(e.bogon)return{ip:t,isp:"N/A",location:"N/A"};let r=e.org??"",i=`${e.city??""}${e.city?", ":""}${e.region??""}${e.region?", ":""}${e.country??""}`;return{ip:t,isp:r,location:i}}catch(e){return console.error(function(){let e=new Date(new Date().getTime()+198e5).toISOString();return`${e.split("T")[0]}_${e.split("T")[1].split(".")[0].split(":").join("-")}`}(),"ipInfo failed:",e),{ip:t,isp:"N/A",location:"N/A"}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[276,437,410],()=>t(1300));module.exports=i})();