"use strict";(()=>{var e={};e.id=660,e.ids=[660],e.modules={5890:e=>{e.exports=require("better-sqlite3")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7790:e=>{e.exports=require("assert")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},9801:e=>{e.exports=require("os")},6624:e=>{e.exports=require("querystring")},6162:e=>{e.exports=require("stream")},4175:e=>{e.exports=require("tty")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},8357:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>A,patchFetch:()=>L,requestAsyncStorage:()=>m,routeModule:()=>T,serverHooks:()=>x,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{GET:()=>E,dynamic:()=>c});var s=t(9303),i=t(8716),n=t(670),a=t(5890),p=t.n(a),u=t(7410),l=t(8706);let c="force-dynamic",d=p()(l.MW);d.prepare(`CREATE TABLE IF NOT EXISTS logs (
	  id INTEGER PRIMARY KEY AUTOINCREMENT,
	  ip TEXT NOT NULL,
	  isp TEXT NOT NULL,
	  location TEXT NOT NULL,
	  userAgent TEXT NOT NULL,
	  createdAt DATETIME DEFAULT CURRENT_TIMESTAMP
	)`).run();let g=u.z.object({id:u.z.string().max(10).optional(),ip:u.z.string().max(500).optional(),isp:u.z.string().max(500).optional(),location:u.z.string().max(500).optional(),userAgent:u.z.string().max(500).optional(),page:u.z.coerce.number().min(1).default(1),perPage:u.z.coerce.number().min(1).default(10)});function E(e){try{let{searchParams:r}=new URL(e.url),t=g.safeParse(Object.fromEntries(r.entries()));if(!t.success)return(0,l.VR)(t.error.errors[0].message,"",400);let{id:o,ip:s,isp:i,location:n,userAgent:a,page:p,perPage:u}=t.data,c="1=1",E=[];o&&(c+=" AND id = ?",E.push(o.toString())),s&&(c+=" AND ip LIKE ?",E.push(`%${s}%`)),i&&(c+=" AND isp LIKE ?",E.push(`%${i}%`)),n&&(c+=" AND location LIKE ?",E.push(`%${n}%`)),a&&(c+=" AND userAgent LIKE ?",E.push(`%${a}%`));let T=(p-1)*u,m=d.prepare(`SELECT COUNT(*) as total FROM logs WHERE ${c}`).all(...E)[0].total,h=d.prepare(`SELECT * FROM logs WHERE ${c}
		  ORDER BY createdAt DESC
		  LIMIT ? OFFSET ?`).all(...E,u,T),x=Math.ceil(m/u);return(0,l.Xj)({logs:h,pagination:{currentPage:p,perPage:u,totalRecords:m,totalPages:x}})}catch(e){return console.error("Error fetching paginated logs:",e),(0,l.VR)("Failed to fetch logs","",500)}}let T=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/v1/adminLogs/route",pathname:"/api/v1/adminLogs",filename:"route",bundlePath:"app/api/v1/adminLogs/route"},resolvedPagePath:"/Users/shubhampanda/Desktop/newmhash/Landing-Page/src/app/api/v1/adminLogs/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:h,serverHooks:x}=T,A="/api/v1/adminLogs/route";function L(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:h})}},8706:(e,r,t)=>{t.d(r,{MW:()=>n,TQ:()=>u,VR:()=>p,Xj:()=>a});var o=t(8566),s=t.n(o),i=t(7070);let n=process.env.SQLITE_DB_PATH??"landing_page_queries.db";function a(e,r){let t=i.NextResponse.json({ok:!0,data:e},{status:r?.status||200});return r?.headers&&Object.entries(r.headers).forEach(([e,r])=>{t.headers.set(e,r)}),t}function p(e,r,t){return r&&console.error(r),i.NextResponse.json({ok:!1,message:e},{status:t})}async function u(e){let r=e.headers.get("x-forwarded-for"),t=r?.split(/, /)[0]??"";try{let e=await s()(t);if(e.bogon)return{ip:t,isp:"N/A",location:"N/A"};let r=e.org??"",o=`${e.city??""}${e.city?", ":""}${e.region??""}${e.region?", ":""}${e.country??""}`;return{ip:t,isp:r,location:o}}catch(e){return console.error(function(){let e=new Date(new Date().getTime()+198e5).toISOString();return`${e.split("T")[0]}_${e.split("T")[1].split(".")[0].split(":").join("-")}`}(),"ipInfo failed:",e),{ip:t,isp:"N/A",location:"N/A"}}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[276,437,410],()=>t(8357));module.exports=o})();